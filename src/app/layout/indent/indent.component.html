<div [@routerTransition] class="content">
  <!-- <app-page-header [heading]="'Indent & Placement'" [icon]="'fa-edit'">
    <div style="background-color: #d4edda;color: #155724">Indent Placed</div>
    <div style="background-color: #dee2e6;color: #212529">Indent Placed</div>
  </app-page-header> -->
  <button (click)="toggle()" id="bt" style="background-color:#FFC10E" class="btn">
      {{buttonName}}
  </button>
  <br/>
  <br/>
  <!-- <agm-map [latitude]="lat" [longitude]="lng">
    <agm-marker *ngFor="let xx of origin" [latitude]="xx.lat" [longitude]="xx.lng"></agm-marker>
    <agm-direction [origin]="origin" [destination]="destination" ></agm-direction>
    <agm-marker *ngFor="let x1 of destination" [latitude]="x1.lat" [longitude]="x1.lng"></agm-marker>
  </agm-map> -->

  <ng-container *ngIf="show">      
  <agm-map [latitude]="lat" [longitude]="lng" [scrollwheel]="true" [zoom]="8" id="AgmMap" #AgmMap >
        <agm-marker *ngFor="let x of indentdtl | filterBy:searchbox; let i = index "  [latitude]="x.lat" [longitude]="x.long" 
        (mouseOver)="onMouseOver(infoWindow, $event)" (mouseOut)="onMouseOut(infoWindow, $event)" (markerClick)="openWindow(x.VehicleNo)" 
        [iconUrl]='{"url": "assets/images/truck.png","scaledSize": {"height": 50, "width": 40}}' >
          <agm-info-window [isOpen]="isInfoWindowOpen(x.VehicleNo)" [disableAutoPan]="false" #infoWindow >
              <div>
                  VehicleNo : <th scope="row">{{x.VehicleNo}}</th>
                  Current Location : <th scope="row">{{x.CurrentLoc}}</th>
                  Pickup Address : <th scope="row">{{x.pickupaddress}}</th>
              </div>
          </agm-info-window>
        </agm-marker>
      </agm-map>
      </ng-container>
      <br/>
      <div class="row">
          <div class="col-xl-4 text-xs-center">
              <div class="form-group has-search">
                  <span class="fa fa-search form-control-feedback"></span>
                  <input class="form-control mr-sm-2" type="text" placeholder="From Location Search" [(ngModel)]="test1" />
              </div>  
          </div>
          <div class="col-xl-4 text-xs-center">
              <div class="form-group has-search">
                  <span class="fa fa-search form-control-feedback"></span>
                  <input class="form-control mr-sm-2" type="text" placeholder="To Location Search" [(ngModel)]="test2" />
              </div>
          </div>
          <div class="col-xl-4 text-xs-center">
              <div class="form-group has-search">
                  <span class="fa fa-search form-control-feedback"></span>
                  <input class="form-control" type="text" placeholder="Vehicle Search" [(ngModel)]="test" />
          </div>  
          </div>
      </div>
  <pagination-controls (pageChange)="p = $event"></pagination-controls>
    <br/>
<div class="table-responsive">    
 <table class="table table-hover" cellspacing="0" width="100%">       
            <thead class="thead-light">
            <tr [(ngModel)]="searchbox">
                <th>Sr.No</th>
                <th>System Genrated Indent</th>
                <th>Origin | Destination</th>
                <th>Indent Date (DD/MM/YY)</th>
                <th>Vehicle No</th>
                <th>Current GPS Location (Recorded at Time)</th>
                <th>Pickup Address</th>
                <th>Customer LVD</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let x of indentdtl |filterBy: {VehicleNo : test, from_loc : test1, to_loc : test2} | paginate: { itemsPerPage: 50, currentPage: p } let i = index" (click)="openWindow(x.orderid)"
            [ngClass] = "{'highlight' : x.orderid == openedWindow, 'activecolor' : x.VehicleNo != 'Vehicle Not Assign'}" 
             tooltip="Green Color Row Indent Is Confirm." href="javascript:void(0)" (click)="open(Emymodal,x.lat,x.long,x.pickuplat,x.pickuplong)" >
            <th scope="row">{{ x.row_num }}</th>
            <th scope="row">{{x.orderid}}</th>    
            <th scope="row">{{x.from_loc}} | {{x.to_loc}}</th>
                <td>{{x.orderdt}}</td>
                <th scope="row">{{x.VehicleNo}}</th>
                <td>{{x.CurrentLoc}}</td>
                <td>{{x.pickupaddress}}</td>
                <td>{{x.CLVD_Inhour}}</td>
            </tr>
            </tbody>
        </table>
    </div>   
      <pagination-controls (pageChange)="p = $event"></pagination-controls>  
</div>
<ng-template #Emymodal let-modal>
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">Map Detals</h4>
          <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            {{lat}}
            {{origin.lat}},{{origin.lng}}
                <agm-map [latitude]="lat" [longitude]="lng">
                       <agm-direction [origin]="origin" [destination]="destination"></agm-direction>
             </agm-map>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Close</button>
        </div>
      </ng-template>   

